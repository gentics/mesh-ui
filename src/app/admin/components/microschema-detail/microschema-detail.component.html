<div *ngIf="version$">
    Version: {{version$ | async}}
</div>

<gtx-tabs>
    <gtx-tab title="Microschemas">
        <mesh-monaco-editor [(ngModel)]="microschemaJson"
                            language="json"
                            [jsonSchema]="schema"
                            (errors)="onErrorChange($event)"></mesh-monaco-editor>

        <gtx-button [disabled]="errors.length > 0 || (loading$ | async)"
                    style="margin-top: 15px;"
                    (click)="save()">{{ 'common.save' | i18n }}</gtx-button>
        <gtx-button type="alert"
                    *ngIf="!isNew"
                    (click)="delete()">{{ 'common.delete_button' | i18n }}</gtx-button>
    </gtx-tab>

    <gtx-tab title="Allocations">
        <mesh-admin-list [items]="projects$ | async"
                         [autoHidePagination]="true"
                         [selectable]="false">

            <div class="list-controls">
                <div class="filter">
                    <gtx-input [label]="'admin.filter_by_name' | i18n"
                               [formControl]="filterInput">
                    </gtx-input>
                </div>
            </div>

            <ng-template let-project="item">
                <gtx-checkbox [label]="project.name"
                              [checked]="projectAssignments[project.uuid]"
                              (change)="onAssignmentChange(project, $event)">
                </gtx-checkbox>
            </ng-template>
        </mesh-admin-list>
    </gtx-tab>

</gtx-tabs>
